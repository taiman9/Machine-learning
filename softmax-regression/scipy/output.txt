[[38. 38.]
 [12. 12.]]
The above two columns you get should be very similar.
Left-Your Numerical Gradient, Right-Analytical Gradient.

2.1452381569477388e-12

Norm of the difference between numerical and analytical gradient (should be < 1e-9)

[[-0.00163356 -0.00163356]
 [-0.02236962 -0.02236962]
 [ 0.01252819  0.01252819]
 [-0.04757691 -0.04757691]
 [-0.07557783 -0.07557783]
 [-0.00957223 -0.00957223]
 [ 0.01762877  0.01762877]
 [-0.02603341 -0.02603341]
 [ 0.03862182  0.03862182]
 [ 0.01656232  0.01656232]
 [ 0.03731156  0.03731156]
 [-0.03321425 -0.03321425]
 [ 0.00067145  0.00067145]
 [ 0.00973924  0.00973924]
 [-0.01011385 -0.01011385]
 [-0.02362957 -0.02362957]
 [-0.00820524 -0.00820524]
 [ 0.01271434  0.01271434]
 [-0.03087598 -0.03087598]
 [ 0.03145277  0.03145277]
 [-0.0115228  -0.0115228 ]
 [-0.00936558 -0.00936558]
 [-0.03936177 -0.03936177]
 [-0.00813307 -0.00813307]
 [-0.0286614  -0.0286614 ]
 [ 0.01982348  0.01982348]
 [ 0.0036943   0.0036943 ]
 [ 0.03549462  0.03549462]
 [ 0.03789451  0.03789451]
 [ 0.01102451  0.01102451]
 [ 0.04457333  0.04457333]
 [-0.04210757 -0.04210757]
 [-0.03537745 -0.03537745]
 [ 0.01688833  0.01688833]
 [-0.0498379  -0.0498379 ]
 [-0.00598633 -0.00598633]
 [ 0.00849908  0.00849908]
 [-0.06087327 -0.06087327]
 [ 0.02071391  0.02071391]
 [ 0.05629408  0.05629408]
 [ 0.00058439  0.00058439]
 [-0.0302805  -0.0302805 ]
 [ 0.02589756  0.02589756]
 [-0.00940137 -0.00940137]
 [-0.00998404 -0.00998404]
 [ 0.01352584  0.01352584]
 [ 0.02841973  0.02841973]
 [ 0.01136842  0.01136842]
 [-0.02334339 -0.02334339]
 [ 0.0180053   0.0180053 ]
 [ 0.0218064   0.0218064 ]
 [-0.00161498 -0.00161498]
 [ 0.01311586  0.01311586]
 [ 0.01613957  0.01613957]
 [-0.04344044 -0.04344044]
 [ 0.00281836  0.00281836]
 [ 0.05292406  0.05292406]
 [-0.02806582 -0.02806582]
 [-0.00775889 -0.00775889]
 [ 0.00081016  0.00081016]
 [ 0.00842062  0.00842062]
 [ 0.02107488  0.02107488]
 [-0.03206676 -0.03206676]
 [ 0.00668312  0.00668312]
 [-0.01210905 -0.01210905]
 [ 0.02222408  0.02222408]
 [ 0.03841351  0.03841351]
 [ 0.01370033  0.01370033]
 [ 0.01210189  0.01210189]
 [ 0.01321548  0.01321548]
 [-0.01723842 -0.01723842]
 [ 0.02806073  0.02806073]
 [ 0.01719979  0.01719979]
 [-0.02549999 -0.02549999]
 [-0.05117821 -0.05117821]
 [ 0.01633727  0.01633727]
 [ 0.01637956  0.01637956]
 [-0.00490758 -0.00490758]
 [ 0.03088417  0.03088417]
 [-0.00531958 -0.00531958]]

6.001464734720439e-10

RUNNING THE L-BFGS-B CODE

           * * *

Machine precision = 2.220D-16
 N =         7840     M =           10

At X0         0 variables are exactly at the bounds

At iterate    0    f=  2.29484D+00    |proj g|=  6.46114D-02

At iterate    1    f=  1.51934D+00    |proj g|=  6.79770D-02

At iterate    2    f=  7.66223D-01    |proj g|=  3.23385D-02

At iterate    3    f=  6.65922D-01    |proj g|=  4.12166D-02

At iterate    4    f=  5.82625D-01    |proj g|=  1.34184D-02

At iterate    5    f=  5.32006D-01    |proj g|=  8.58348D-03

At iterate    6    f=  4.87631D-01    |proj g|=  1.17393D-02

At iterate    7    f=  4.66566D-01    |proj g|=  2.49632D-02

At iterate    8    f=  4.43927D-01    |proj g|=  9.03459D-03

At iterate    9    f=  4.32298D-01    |proj g|=  4.52142D-03

At iterate   10    f=  4.20627D-01    |proj g|=  6.92151D-03

At iterate   11    f=  4.04633D-01    |proj g|=  8.83073D-03

At iterate   12    f=  3.80967D-01    |proj g|=  9.46040D-03

At iterate   13    f=  3.64511D-01    |proj g|=  6.84112D-03

At iterate   14    f=  3.50474D-01    |proj g|=  3.69460D-03

At iterate   15    f=  3.46485D-01    |proj g|=  3.41408D-03

At iterate   16    f=  3.42185D-01    |proj g|=  2.72544D-03

At iterate   17    f=  3.37013D-01    |proj g|=  4.01754D-03

At iterate   18    f=  3.33513D-01    |proj g|=  7.72411D-03

At iterate   19    f=  3.26164D-01    |proj g|=  2.36230D-03

At iterate   20    f=  3.22703D-01    |proj g|=  1.82283D-03

At iterate   21    f=  3.19159D-01    |proj g|=  2.35554D-03

At iterate   22    f=  3.18668D-01    |proj g|=  8.94593D-03

At iterate   23    f=  3.13245D-01    |proj g|=  1.83228D-03

At iterate   24    f=  3.12006D-01    |proj g|=  1.16282D-03

At iterate   25    f=  3.10519D-01    |proj g|=  1.84443D-03

At iterate   26    f=  3.08501D-01    |proj g|=  2.00608D-03

At iterate   27    f=  3.07756D-01    |proj g|=  5.92913D-03

At iterate   28    f=  3.04595D-01    |proj g|=  1.65896D-03

At iterate   29    f=  3.03405D-01    |proj g|=  1.48026D-03

At iterate   30    f=  3.01841D-01    |proj g|=  1.63622D-03

At iterate   31    f=  2.99948D-01    |proj g|=  1.84695D-03

At iterate   32    f=  2.99350D-01    |proj g|=  4.36615D-03

At iterate   33    f=  2.97609D-01    |proj g|=  1.40967D-03

At iterate   34    f=  2.96853D-01    |proj g|=  1.22940D-03

At iterate   35    f=  2.95348D-01    |proj g|=  1.83057D-03

At iterate   36    f=  2.93707D-01    |proj g|=  2.69342D-03

At iterate   37    f=  2.92485D-01    |proj g|=  1.86024D-03

At iterate   38    f=  2.91488D-01    |proj g|=  1.18913D-03

At iterate   39    f=  2.90548D-01    |proj g|=  1.56484D-03

At iterate   40    f=  2.89668D-01    |proj g|=  1.84886D-03

At iterate   41    f=  2.88934D-01    |proj g|=  3.26220D-03

At iterate   42    f=  2.87658D-01    |proj g|=  1.45453D-03

At iterate   43    f=  2.86976D-01    |proj g|=  7.94319D-04

At iterate   44    f=  2.86046D-01    |proj g|=  1.37683D-03

At iterate   45    f=  2.85109D-01    |proj g|=  1.41280D-03

At iterate   46    f=  2.84305D-01    |proj g|=  2.29247D-03

At iterate   47    f=  2.83523D-01    |proj g|=  8.62423D-04

At iterate   48    f=  2.83039D-01    |proj g|=  9.91289D-04

At iterate   49    f=  2.82598D-01    |proj g|=  1.04938D-03

At iterate   50    f=  2.82293D-01    |proj g|=  3.55250D-03

At iterate   51    f=  2.80975D-01    |proj g|=  1.27513D-03

At iterate   52    f=  2.80625D-01    |proj g|=  8.05945D-04

At iterate   53    f=  2.80172D-01    |proj g|=  1.18617D-03

At iterate   54    f=  2.79674D-01    |proj g|=  1.08202D-03

At iterate   55    f=  2.79081D-01    |proj g|=  1.50077D-03

At iterate   56    f=  2.78637D-01    |proj g|=  7.11062D-04

At iterate   57    f=  2.78258D-01    |proj g|=  7.46572D-04

At iterate   58    f=  2.77902D-01    |proj g|=  7.95510D-04

At iterate   59    f=  2.77165D-01    |proj g|=  1.62208D-03

At iterate   60    f=  2.76686D-01    |proj g|=  1.23922D-03

At iterate   61    f=  2.76371D-01    |proj g|=  6.68187D-04

At iterate   62    f=  2.76070D-01    |proj g|=  7.37914D-04

At iterate   63    f=  2.75781D-01    |proj g|=  8.83998D-04

At iterate   64    f=  2.75366D-01    |proj g|=  7.50482D-04

At iterate   65    f=  2.75281D-01    |proj g|=  1.94529D-03

At iterate   66    f=  2.74883D-01    |proj g|=  7.14208D-04

At iterate   67    f=  2.74744D-01    |proj g|=  5.99103D-04

At iterate   68    f=  2.74487D-01    |proj g|=  7.92528D-04

At iterate   69    f=  2.74193D-01    |proj g|=  1.57330D-03

At iterate   70    f=  2.73901D-01    |proj g|=  8.89734D-04

At iterate   71    f=  2.73720D-01    |proj g|=  4.76997D-04

At iterate   72    f=  2.73538D-01    |proj g|=  6.08901D-04

At iterate   73    f=  2.73361D-01    |proj g|=  7.39109D-04

At iterate   74    f=  2.73001D-01    |proj g|=  1.04602D-03

At iterate   75    f=  2.72811D-01    |proj g|=  9.36100D-04

At iterate   76    f=  2.72652D-01    |proj g|=  5.25456D-04

At iterate   77    f=  2.72482D-01    |proj g|=  4.74570D-04

At iterate   78    f=  2.72327D-01    |proj g|=  6.46641D-04

At iterate   79    f=  2.71981D-01    |proj g|=  8.00823D-04

At iterate   80    f=  2.71875D-01    |proj g|=  7.51971D-04

At iterate   81    f=  2.71671D-01    |proj g|=  4.85249D-04

At iterate   82    f=  2.71580D-01    |proj g|=  9.59728D-04

At iterate   83    f=  2.71450D-01    |proj g|=  5.12043D-04

At iterate   84    f=  2.71347D-01    |proj g|=  5.22653D-04

At iterate   85    f=  2.71169D-01    |proj g|=  5.48931D-04

At iterate   86    f=  2.70927D-01    |proj g|=  5.75672D-04

At iterate   87    f=  2.70860D-01    |proj g|=  1.10265D-03

At iterate   88    f=  2.70648D-01    |proj g|=  5.19868D-04

At iterate   89    f=  2.70525D-01    |proj g|=  2.80740D-04

At iterate   90    f=  2.70327D-01    |proj g|=  4.75121D-04

At iterate   91    f=  2.70248D-01    |proj g|=  6.40303D-04

At iterate   92    f=  2.70149D-01    |proj g|=  4.13076D-04

At iterate   93    f=  2.70026D-01    |proj g|=  3.42447D-04

At iterate   94    f=  2.69943D-01    |proj g|=  1.02325D-03

At iterate   95    f=  2.69845D-01    |proj g|=  4.72235D-04

At iterate   96    f=  2.69739D-01    |proj g|=  3.17076D-04

At iterate   97    f=  2.69674D-01    |proj g|=  3.92590D-04

At iterate   98    f=  2.69511D-01    |proj g|=  6.21783D-04

At iterate   99    f=  2.69457D-01    |proj g|=  6.89959D-04

At iterate  100    f=  2.69362D-01    |proj g|=  3.35212D-04

           * * *

Tit   = total number of iterations
Tnf   = total number of function evaluations
Tnint = total number of segments explored during Cauchy searches
Skip  = number of BFGS updates skipped
Nact  = number of active bounds at final generalized Cauchy point
Projg = norm of the final projected gradient
F     = final function value

           * * *

   N    Tit     Tnf  Tnint  Skip  Nact     Projg        F
 7840    100    107      1     0     0   3.352D-04   2.694D-01
  F =  0.26936204482451048     

STOP: TOTAL NO. of ITERATIONS REACHED LIMIT                 

 Cauchy                time 0.000E+00 seconds.
 Subspace minimization time 0.000E+00 seconds.
 Line search           time 0.000E+00 seconds.

 Total User time 0.000E+00 seconds.

Array of loss value at each epoch(for plotting):

[1.51934041 0.76622297 0.66592247 0.58262472 0.53200633 0.48763141
 0.46656628 0.44392654 0.43229807 0.42062724 0.40463307 0.38096675
 0.36451125 0.35047372 0.34648454 0.34218539 0.33701311 0.33351308
 0.3261637  0.32270343 0.31915858 0.31866849 0.31324517 0.31200603
 0.31051905 0.30850148 0.3077563  0.30459476 0.30340489 0.30184109
 0.29994759 0.29935001 0.29760851 0.29685336 0.29534818 0.293707
 0.29248477 0.29148787 0.29054836 0.28966763 0.28893367 0.28765809
 0.28697586 0.28604645 0.28510899 0.2843048  0.28352281 0.28303908
 0.28259838 0.28229254 0.28097466 0.28062453 0.28017223 0.27967431
 0.27908134 0.27863726 0.27825827 0.2779023  0.27716502 0.27668573
 0.27637098 0.27606983 0.27578122 0.27536552 0.27528119 0.27488318
 0.27474425 0.27448668 0.27419307 0.27390096 0.27372011 0.27353839
 0.27336122 0.27300087 0.27281119 0.27265167 0.27248188 0.27232705
 0.2719807  0.27187476 0.2716707  0.2715805  0.27145041 0.27134672
 0.27116857 0.27092704 0.27086016 0.27064805 0.27052523 0.27032734
 0.27024775 0.27014868 0.27002567 0.26994314 0.26984465 0.2697387
 0.26967368 0.26951091 0.26945722 0.26936204]

Accuracy: 92.520%.

Confusion matrix: 

[[ 962    0    0    2    0    3    6    4    3    0]
 [   0 1113    3    2    0    1    4    2   10    0]
 [   5   10  925   14    8    3   14   10   40    3]
 [   3    1   21  916    0   27    4    9   22    7]
 [   1    1    4    3  919    0   10    3    9   32]
 [   9    3    2   36    9  772   12    8   34    7]
 [   9    3    5    2    8   18  910    2    1    0]
 [   1    7   22    6    6    1    0  953    3   29]
 [   8    9    6   25    8   26   11   11  862    8]
 [  10    7    1    7   24    9    0   23    8  920]]

